name: main

on:
  workflow_dispatch:

jobs:
  build:
    name: test1
    runs-on: ubuntu-latest
    steps:
      - name: Build
        run: echo building

  deploy:
    name: deploy
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Manual Approval
        id: manual_approval
        run: echo "Approve the deployment by commenting on the pull request"
        continue-on-error: true

      - name: Check Approval
        run: exit ${{ success(github.event_name == 'pull_request' && contains(github.event.comment.body, 'approve')) }}

      - name: Deploy to production
        run: echo deploying
        if: steps.manual_approval.outputs.result == 'success'
